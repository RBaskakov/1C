В процедуре ОбработкаПроведения документа ПоступлениеТоваровУслуг (или в вызываемых процедурах) найти код, в котором формируются движения по регистру НДСпоКосвеннымРасходам и сделать этот участок кода в блоке Если. В условии Если надо проверить, что Флаг "Организация выступает… " (далее – Флаг) реквизита Договор равен Ложь или Неопределено. Создать функцию модуля формы договора ЗапрещеныИзмененияРеквизита, выполняемую НаСервереБезКонтекста. Функция возвращает булево, аргумент Договор. В функции сначала проверять доступность роли «Полные права»», если роль доступна текущему пользователю, возвращать Ложь. Далее запросом получить все документы  для данного договора и с признаком «Проведен». Если результат запроса пустой, функция возвращает Ложь, в противном случае Истину. В событии ПриИзменении Флага вызывать функцию ЗапрещеныИзмененияРеквизита, аргумент - договор из формы (ЭтотОбъект.Объект.Ссылка). Если эта функция возвращает Истина, то менять значение Флага.
